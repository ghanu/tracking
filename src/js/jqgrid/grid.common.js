var showModal=function(b){b.w.show()};var closeModal=function(b){b.w.hide().attr("aria-hidden","true");if(b.o){b.o.remove()}};var hideModal=function(h,e){e=jQuery.extend({jqm:true,gb:""},e||{});if(e.onClose){var g=e.onClose(h);if(typeof g=="boolean"&&!g){return}}if(jQuery.fn.jqm&&e.jqm===true){jQuery(h).attr("aria-hidden","true").jqmHide()}else{if(e.gb!=""){try{jQuery(".jqgrid-overlay:first",e.gb).hide()}catch(f){}}jQuery(h).hide().attr("aria-hidden","true")}};function findPos(f){var e=0,d=0;if(f.offsetParent){do{e+=f.offsetLeft;d+=f.offsetTop}while(f=f.offsetParent)}return[e,d]}var createModal=function(p,v,B,C,x,z){var r=document.createElement("div"),D;D=jQuery(B.gbox).attr("dir")=="rtl"?true:false;r.className="ui-widget ui-widget-content ui-corner-all ui-jqdialog";r.id=p.themodal;var y=document.createElement("div");y.className="ui-jqdialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix";y.id=p.modalhead;jQuery(y).append("<span class='ui-jqdialog-title'>"+B.caption+"</span>");var e=jQuery("<a href='javascript:void(0)' class='ui-jqdialog-titlebar-close ui-corner-all'></a>").hover(function(){e.addClass("ui-state-hover")},function(){e.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-closethick'></span>");jQuery(y).append(e);if(D){r.dir="rtl";jQuery(".ui-jqdialog-title",y).css("float","right");jQuery(".ui-jqdialog-titlebar-close",y).css("left",0.3+"em")}else{r.dir="ltr";jQuery(".ui-jqdialog-title",y).css("float","left");jQuery(".ui-jqdialog-titlebar-close",y).css("right",0.3+"em")}var t=document.createElement("div");jQuery(t).addClass("ui-jqdialog-content ui-widget-content").attr("id",p.modalcontent);jQuery(t).append(v);r.appendChild(t);jQuery(r).prepend(y);if(z===true){jQuery("body").append(r)}else{jQuery(r).insertBefore(C)}if(typeof B.jqModal==="undefined"){B.jqModal=true}var A={};if(jQuery.fn.jqm&&B.jqModal===true){if(B.left===0&&B.top===0){var u=[];u=findPos(x);B.left=u[0]+4;B.top=u[1]+4}A.top=B.top+"px";A.left=B.left}else{if(B.left!==0||B.top!==0){A.left=B.left;A.top=B.top+"px"}}jQuery("a.ui-jqdialog-titlebar-close",y).click(function(c){var a=jQuery("#"+p.themodal).data("onClose")||B.onClose;var b=jQuery("#"+p.themodal).data("gbox")||B.gbox;hideModal("#"+p.themodal,{gb:b,jqm:B.jqModal,onClose:a});return false});if(B.width===0||!B.width){B.width=300}if(B.height===0||!B.height){B.height=200}if(!B.zIndex){B.zIndex=950}var s=0;if(D&&A.left&&!z){s=jQuery(B.gbox).width()-(!isNaN(B.width)?parseInt(B.width,10):0)-8;A.left=parseInt(A.left,10)+parseInt(s,10)}if(A.left){A.left+="px"}jQuery(r).css(jQuery.extend({width:isNaN(B.width)?"auto":B.width+"px",height:isNaN(B.height)?"auto":B.height+"px",zIndex:B.zIndex,overflow:"hidden"},A)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":p.modalhead,"aria-hidden":"true"});if(typeof B.drag=="undefined"){B.drag=true}if(typeof B.resize=="undefined"){B.resize=true}if(B.drag){jQuery(y).css("cursor","move");if(jQuery.fn.jqDrag){jQuery(r).jqDrag(y)}else{try{jQuery(r).draggable({handle:jQuery("#"+y.id)})}catch(w){}}}if(B.resize){if(jQuery.fn.jqResize){jQuery(r).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se ui-icon-grip-diagonal-se'></div>");jQuery("#"+p.themodal).jqResize(".jqResize",p.scrollelm?"#"+p.scrollelm:false)}else{try{jQuery(r).resizable({handles:"se, sw",alsoResize:p.scrollelm?"#"+p.scrollelm:false})}catch(w){}}}if(B.closeOnEscape===true){jQuery(r).keydown(function(b){if(b.which==27){var a=jQuery("#"+p.themodal).data("onClose")||B.onClose;hideModal(this,{gb:B.gbox,jqm:B.jqModal,onClose:a})}})}};var viewModal=function(d,e){e=jQuery.extend({toTop:true,overlay:10,modal:false,onShow:showModal,onHide:closeModal,gbox:"",jqm:true,jqM:true},e||{});if(jQuery.fn.jqm&&e.jqm===true){if(e.jqM){jQuery(d).attr("aria-hidden","false").jqm(e).jqmShow()}else{jQuery(d).attr("aria-hidden","false").jqmShow()}}else{if(e.gbox!=""){jQuery(".jqgrid-overlay:first",e.gbox).show();jQuery(d).data("gbox",e.gbox)}jQuery(d).show().attr("aria-hidden","false");try{jQuery(":input:visible",d)[0].focus()}catch(f){}}};function info_dialog(s,x,q,t){var v={width:290,height:"auto",dataheight:"auto",drag:true,resize:false,caption:"<b>"+s+"</b>",left:250,top:170,zIndex:1000,jqModal:true,modal:false,closeOnEscape:true,align:"center",buttonalign:"center",buttons:[]};jQuery.extend(v,t||{});var p=v.jqModal;if(jQuery.fn.jqm&&!p){p=false}var i="";if(v.buttons.length>0){for(var o=0;o<v.buttons.length;o++){if(typeof v.buttons[o].id=="undefined"){v.buttons[o].id="info_button_"+o}i+="<a href='javascript:void(0)' id='"+v.buttons[o].id+"' class='fm-button ui-state-default ui-corner-all'>"+v.buttons[o].text+"</a>"}}var w=isNaN(v.dataheight)?v.dataheight:v.dataheight+"px",u="text-align:"+v.align+";";var r="<div id='info_id'>";r+="<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+w+";"+u+"'>"+x+"</div>";r+=q?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+v.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a href='javascript:void(0)' id='closedialog' class='fm-button ui-state-default ui-corner-all'>"+q+"</a>"+i+"</div>":i!=""?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+v.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+i+"</div>":"";r+="</div>";try{if(jQuery("#info_dialog").attr("aria-hidden")=="false"){hideModal("#info_dialog",{jqm:p})}jQuery("#info_dialog").remove()}catch(e){}createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},r,v,"","",true);if(i){jQuery.each(v.buttons,function(a){jQuery("#"+this.id,"#info_id").bind("click",function(){v.buttons[a].onClick.call(jQuery("#info_dialog"));return false})})}jQuery("#closedialog","#info_id").click(function(a){hideModal("#info_dialog",{jqm:p});return false});jQuery(".fm-button","#info_dialog").hover(function(){jQuery(this).addClass("ui-state-hover")},function(){jQuery(this).removeClass("ui-state-hover")});if(jQuery.isFunction(v.beforeOpen)){v.beforeOpen()}viewModal("#info_dialog",{onHide:function(a){a.w.hide().remove();if(a.o){a.o.remove()}},modal:v.modal,jqm:p});if(jQuery.isFunction(v.afterOpen)){v.afterOpen()}try{$("#info_dialog").focus()}catch(e){}}function createEl(K,I,F,C,J){var H="";if(I.defaultValue){delete I.defaultValue}function B(a,b){if(jQuery.isFunction(b.dataInit)){a.id=b.id;b.dataInit(a);delete b.id;delete b.dataInit}if(b.dataEvents){jQuery.each(b.dataEvents,function(){if(this.data!==undefined){jQuery(a).bind(this.type,this.data,this.fn)}else{jQuery(a).bind(this.type,this.fn)}});delete b.dataEvents}return b}switch(K){case"textarea":H=document.createElement("textarea");if(C){if(!I.cols){jQuery(H).css({width:"98%"})}}else{if(!I.cols){I.cols=20}}if(!I.rows){I.rows=2}if(F=="&nbsp;"||F=="&#160;"||(F.length==1&&F.charCodeAt(0)==160)){F=""}H.value=F;I=B(H,I);jQuery(H).attr(I).attr({role:"textbox",multiline:"true"});break;case"checkbox":H=document.createElement("input");H.type="checkbox";if(!I.value){var e=F.toLowerCase();if(e.search(/(false|0|no|off|undefined)/i)<0&&e!==""){H.checked=true;H.defaultChecked=true;H.value=F}else{H.value="on"}jQuery(H).attr("offval","off")}else{var z=I.value.split(":");if(F===z[0]){H.checked=true;H.defaultChecked=true}H.value=z[0];jQuery(H).attr("offval",z[1]);try{delete I.value}catch(w){}}I=B(H,I);jQuery(H).attr(I).attr("role","checkbox");break;case"select":H=document.createElement("select");H.setAttribute("role","select");var M,G=[];if(I.multiple===true){M=true;H.multiple="multiple";$(H).attr("aria-multiselectable","true")}else{M=false}if(typeof(I.dataUrl)!="undefined"){jQuery.ajax(jQuery.extend({url:I.dataUrl,type:"GET",dataType:"html",success:function(b,c){try{delete I.dataUrl;delete I.value}catch(a){}var d;if(typeof(I.buildSelect)!="undefined"){var f=I.buildSelect(b);d=jQuery(f).html();delete I.buildSelect}else{d=jQuery(b).html()}if(d){jQuery(H).append(d);I=B(H,I);if(typeof I.size==="undefined"){I.size=M?3:1}if(M){G=F.split(",");G=jQuery.map(G,function(g){return jQuery.trim(g)})}else{G[0]=jQuery.trim(F)}jQuery(H).attr(I);setTimeout(function(){jQuery("option",H).each(function(g){if(g===0){this.selected=""}$(this).attr("role","option");if(jQuery.inArray(jQuery.trim(jQuery(this).text()),G)>-1||jQuery.inArray(jQuery.trim(jQuery(this).val()),G)>-1){this.selected="selected";if(!M){return false}}})},0)}}},J||{}))}else{if(I.value){var y;if(M){G=F.split(",");G=jQuery.map(G,function(a){return jQuery.trim(a)});if(typeof I.size==="undefined"){I.size=3}}else{I.size=1}if(typeof I.value==="function"){I.value=I.value()}var x,A,D;if(typeof I.value==="string"){x=I.value.split(";");for(y=0;y<x.length;y++){A=x[y].split(":");if(A.length>2){A[1]=jQuery.map(A,function(a,b){if(b>0){return a}}).join(":")}D=document.createElement("option");D.setAttribute("role","option");D.value=A[0];D.innerHTML=A[1];if(!M&&(jQuery.trim(A[0])==jQuery.trim(F)||jQuery.trim(A[1])==jQuery.trim(F))){D.selected="selected"}if(M&&(jQuery.inArray(jQuery.trim(A[1]),G)>-1||jQuery.inArray(jQuery.trim(A[0]),G)>-1)){D.selected="selected"}H.appendChild(D)}}else{if(typeof I.value==="object"){var L=I.value;for(var i in L){if(L.hasOwnProperty(i)){D=document.createElement("option");D.setAttribute("role","option");D.value=i;D.innerHTML=L[i];if(!M&&(jQuery.trim(i)==jQuery.trim(F)||jQuery.trim(L[i])==jQuery.trim(F))){D.selected="selected"}if(M&&(jQuery.inArray(jQuery.trim(L[i]),G)>-1||jQuery.inArray(jQuery.trim(i),G)>-1)){D.selected="selected"}H.appendChild(D)}}}}I=B(H,I);try{delete I.value}catch(w){}jQuery(H).attr(I)}}break;case"text":case"password":case"button":var E;if(K=="button"){E="button"}else{E="textbox"}H=document.createElement("input");H.type=K;H.value=F;I=B(H,I);if(K!="button"){if(C){if(!I.size){jQuery(H).css({width:"98%"})}}else{if(!I.size){I.size=20}}}jQuery(H).attr(I).attr("role",E);break;case"image":case"file":H=document.createElement("input");H.type=K;I=B(H,I);jQuery(H).attr(I);break;case"custom":H=document.createElement("span");try{if(jQuery.isFunction(I.custom_element)){var N=I.custom_element.call(this,F,I);if(N){N=jQuery(N).addClass("customelement").attr({id:I.id,name:I.name});jQuery(H).empty().append(N)}else{throw"e2"}}else{throw"e1"}}catch(w){if(w=="e1"){info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_element' "+jQuery.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}if(w=="e2"){info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_element' "+jQuery.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{info_dialog(jQuery.jgrid.errors.errcap,typeof(w)==="string"?w:w.message,jQuery.jgrid.edit.bClose)}}break}return H}function daysInFebruary(b){return(((b%4===0)&&(b%100!==0||(b%400===0)))?29:28)}function DaysArray(c){for(var d=1;d<=c;d++){this[d]=31;if(d==4||d==6||d==9||d==11){this[d]=30}if(d==2){this[d]=29}}return this}function checkDate(u,p){var j={},s;u=u.toLowerCase();if(u.indexOf("/")!=-1){s="/"}else{if(u.indexOf("-")!=-1){s="-"}else{if(u.indexOf(".")!=-1){s="."}else{s="/"}}}u=u.split(s);p=p.split(s);if(p.length!=3){return false}var i=-1,t,x=-1,o=-1;for(var w=0;w<u.length;w++){var q=isNaN(p[w])?0:parseInt(p[w],10);j[u[w]]=q;t=u[w];if(t.indexOf("y")!=-1){i=w}if(t.indexOf("m")!=-1){o=w}if(t.indexOf("d")!=-1){x=w}}if(u[i]=="y"||u[i]=="yyyy"){t=4}else{if(u[i]=="yy"){t=2}else{t=-1}}var r=DaysArray(12);var v;if(i===-1){return false}else{v=j[u[i]].toString();if(t==2&&v.length==1){t=1}if(v.length!=t||(j[u[i]]===0&&p[i]!="00")){return false}}if(o===-1){return false}else{v=j[u[o]].toString();if(v.length<1||j[u[o]]<1||j[u[o]]>12){return false}}if(x===-1){return false}else{v=j[u[x]].toString();if(v.length<1||j[u[x]]<1||j[u[x]]>31||(j[u[o]]==2&&j[u[x]]>daysInFebruary(j[u[i]]))||j[u[x]]>r[j[u[o]]]){return false}}return true}function isEmpty(b){if(b.match(/^\s+$/)||b==""){return true}else{return false}}function checkTime(e){var f=/^(\d{1,2}):(\d{2})([ap]m)?$/,d;if(!isEmpty(e)){d=e.match(f);if(d){if(d[3]){if(d[1]<1||d[1]>12){return false}}else{if(d[1]>23){return false}}if(d[2]>59){return false}}else{return false}}return true}function checkValues(i,q,t){var v,u,p,g;if(typeof(q)=="string"){for(u=0,len=t.p.colModel.length;u<len;u++){if(t.p.colModel[u].name==q){v=t.p.colModel[u].editrules;q=u;try{p=t.p.colModel[u].formoptions.label}catch(r){}break}}}else{if(q>=0){v=t.p.colModel[q].editrules}}if(v){if(!p){p=t.p.colNames[q]}if(v.required===true){if(isEmpty(i)){return[false,p+": "+jQuery.jgrid.edit.msg.required,""]}}var e=v.required===false?false:true;if(v.number===true){if(!(e===false&&isEmpty(i))){if(isNaN(i)){return[false,p+": "+jQuery.jgrid.edit.msg.number,""]}}}if(typeof v.minValue!="undefined"&&!isNaN(v.minValue)){if(parseFloat(i)<parseFloat(v.minValue)){return[false,p+": "+jQuery.jgrid.edit.msg.minValue+" "+v.minValue,""]}}if(typeof v.maxValue!="undefined"&&!isNaN(v.maxValue)){if(parseFloat(i)>parseFloat(v.maxValue)){return[false,p+": "+jQuery.jgrid.edit.msg.maxValue+" "+v.maxValue,""]}}var o;if(v.email===true){if(!(e===false&&isEmpty(i))){o=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;if(!o.test(i)){return[false,p+": "+jQuery.jgrid.edit.msg.email,""]}}}if(v.integer===true){if(!(e===false&&isEmpty(i))){if(isNaN(i)){return[false,p+": "+jQuery.jgrid.edit.msg.integer,""]}if((i%1!==0)||(i.indexOf(".")!=-1)){return[false,p+": "+jQuery.jgrid.edit.msg.integer,""]}}}if(v.date===true){if(!(e===false&&isEmpty(i))){if(t.p.colModel[q].formatoptions&&t.p.colModel[q].formatoptions.newformat){g=t.p.colModel[q].formatoptions.newformat}else{g=t.p.colModel[q].datefmt||"Y-m-d"}if(!checkDate(g,i)){return[false,p+": "+jQuery.jgrid.edit.msg.date+" - "+g,""]}}}if(v.time===true){if(!(e===false&&isEmpty(i))){if(!checkTime(i)){return[false,p+": "+jQuery.jgrid.edit.msg.date+" - hh:mm (am/pm)",""]}}}if(v.url===true){if(!(e===false&&isEmpty(i))){o=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;if(!o.test(i)){return[false,p+": "+jQuery.jgrid.edit.msg.url,""]}}}if(v.custom===true){if(!(e===false&&isEmpty(i))){if(jQuery.isFunction(v.custom_func)){var s=v.custom_func.call(t,i,p);if(jQuery.isArray(s)){return s}else{return[false,jQuery.jgrid.edit.msg.customarray,""]}}else{return[false,jQuery.jgrid.edit.msg.customfcheck,""]}}}}return[true,"",""]};