(function(e){e.fmatter={};e.fn.fmatter=function(j,i,a,c,b){a=e.extend({},e.jgrid.formatter,a);return d(j,i,a,c,b)};e.fmatter.util={NumberFormat:function(i,r){if(!isNumber(i)){i*=1}if(isNumber(i)){var b=(i<0);var u=i+"";var x=(r.decimalSeparator)?r.decimalSeparator:".";var w;if(isNumber(r.decimalPlaces)){var v=r.decimalPlaces;var c=Math.pow(10,v);u=Math.round(i*c)/c+"";w=u.lastIndexOf(".");if(v>0){if(w<0){u+=x;w=u.length-1}else{if(x!=="."){u=u.replace(".",x)}}while((u.length-1-w)<v){u+="0"}}}if(r.thousandsSeparator){var s=r.thousandsSeparator;w=u.lastIndexOf(x);w=(w>-1)?w:u.length;var t=u.substring(w);var q=-1;for(var a=w;a>0;a--){q++;if((q%3===0)&&(a!==w)&&(!b||(a>1))){t=s+t}t=u.charAt(a-1)+t}u=t}u=(r.prefix)?r.prefix+u:u;u=(r.suffix)?u+r.suffix:u;return u}else{return i}},DateFormat:function(G,k,b,N){var X=/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,Q=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,n=/[^-+\dA-Z]/g,w=function(g,h){g=String(g);h=parseInt(h,10)||2;while(g.length<h){g="0"+g}return g},c={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},aa=0,U,o,ab,u=["i18n"];u.i18n={dayNames:N.dayNames,monthNames:N.monthNames};if(G in N.masks){G=N.masks[G]}if(k.constructor===Number){aa=new Date(k)}else{if(k.constructor===Date){aa=k}else{k=k.split(/[\\\/:_;.\t\T\s-]/);G=G.split(/[\\\/:_;.\t\T\s-]/);for(o=0,ab=G.length;o<ab;o++){if(G[o]=="M"){U=e.inArray(k[o],u.i18n.monthNames);if(U!==-1&&U<12){k[o]=U+1}}if(G[o]=="F"){U=e.inArray(k[o],u.i18n.monthNames);if(U!==-1&&U>11){k[o]=U+1-12}}if(k[o]){c[G[o].toLowerCase()]=parseInt(k[o],10)}}if(c.m==0&&c.y==0&&c.d==0){return"&#160;"}c.m=parseInt(c.m,10)-1;var i=c.y;if(i>=70&&i<=99){c.y=1900+c.y}else{if(i>=0&&i<=69){c.y=2000+c.y}}aa=new Date(c.y,c.m,c.d,c.h,c.i,c.s,c.u)}}if(b in N.masks){b=N.masks[b]}else{if(!b){b="Y-m-d"}}var T=aa.getHours(),P=aa.getMinutes(),j=aa.getDate(),S=aa.getMonth()+1,W=aa.getTimezoneOffset(),s=aa.getSeconds(),R=aa.getMilliseconds(),z=aa.getDay(),a=aa.getFullYear(),Y=(z+6)%7+1,V=(new Date(a,S-1,j)-new Date(a,0,1))/86400000,Z={d:w(j),D:u.i18n.dayNames[z],j:j,l:u.i18n.dayNames[z+7],N:Y,S:N.S(j),w:z,z:V,W:Y<5?Math.floor((V+Y-1)/7)+1:Math.floor((V+Y-1)/7)||((new Date(a-1,0,1).getDay()+6)%7<4?53:52),F:u.i18n.monthNames[S-1+12],m:w(S),M:u.i18n.monthNames[S-1],n:S,t:"?",L:"?",o:"?",Y:a,y:String(a).substring(2),a:T<12?N.AmPm[0]:N.AmPm[1],A:T<12?N.AmPm[2]:N.AmPm[3],B:"?",g:T%12||12,G:T,h:w(T%12||12),H:w(T),i:w(P),s:w(s),u:R,e:"?",I:"?",O:(W>0?"-":"+")+w(Math.floor(Math.abs(W)/60)*100+Math.abs(W)%60,4),P:"?",T:(String(aa).match(Q)||[""]).pop().replace(n,""),Z:"?",c:"?",r:"?",U:Math.floor(aa/1000)};return b.replace(X,function(g){return g in Z?Z[g]:g.substring(1)})}};e.fn.fmatter.defaultFormat=function(a,b){return(isValue(a)&&a!=="")?a:b.defaultValue?b.defaultValue:"&#160;"};e.fn.fmatter.email=function(a,b){if(!isEmpty(a)){return'<a href="mailto:'+a+'">'+a+"</a>"}else{return e.fn.fmatter.defaultFormat(a,b)}};e.fn.fmatter.checkbox=function(j,b){var i=e.extend({},b.checkbox),a;if(!isUndefined(b.colModel.formatoptions)){i=e.extend({},i,b.colModel.formatoptions)}if(i.disabled===true){a="disabled"}else{a=""}if(isEmpty(j)||isUndefined(j)){j=e.fn.fmatter.defaultFormat(j,i)}j=j+"";j=j.toLowerCase();var c=j.search(/(false|0|no|off)/i)<0?" checked='checked' ":"";return'<input type="checkbox" '+c+' value="'+j+'" offval="no" '+a+"/>"};e.fn.fmatter.link=function(h,b){var c={target:b.target};var a="";if(!isUndefined(b.colModel.formatoptions)){c=e.extend({},c,b.colModel.formatoptions)}if(c.target){a="target="+c.target}if(!isEmpty(h)){return"<a "+a+' href="'+h+'">'+h+"</a>"}else{return e.fn.fmatter.defaultFormat(h,b)}};e.fn.fmatter.showlink=function(a,c){var i={baseLinkUrl:c.baseLinkUrl,showAction:c.showAction,addParam:c.addParam||"",target:c.target,idName:c.idName},b="",j;if(!isUndefined(c.colModel.formatoptions)){i=e.extend({},i,c.colModel.formatoptions)}if(i.target){b="target="+i.target}j=i.baseLinkUrl+i.showAction+"?"+i.idName+"="+c.rowId+i.addParam;if(isString(a)||isNumber(a)){return"<a "+b+' href="'+j+'">'+a+"</a>"}else{return e.fn.fmatter.defaultFormat(a,c)}};e.fn.fmatter.integer=function(c,a){var b=e.extend({},a.integer);if(!isUndefined(a.colModel.formatoptions)){b=e.extend({},b,a.colModel.formatoptions)}if(isEmpty(c)){return b.defaultValue}return e.fmatter.util.NumberFormat(c,b)};e.fn.fmatter.number=function(c,a){var b=e.extend({},a.number);if(!isUndefined(a.colModel.formatoptions)){b=e.extend({},b,a.colModel.formatoptions)}if(isEmpty(c)){return b.defaultValue}return e.fmatter.util.NumberFormat(c,b)};e.fn.fmatter.currency=function(c,a){var b=e.extend({},a.currency);if(!isUndefined(a.colModel.formatoptions)){b=e.extend({},b,a.colModel.formatoptions)}if(isEmpty(c)){return b.defaultValue}return e.fmatter.util.NumberFormat(c,b)};e.fn.fmatter.date=function(j,a,c,b){var i=e.extend({},a.date);if(!isUndefined(a.colModel.formatoptions)){i=e.extend({},i,a.colModel.formatoptions)}if(!i.reformatAfterEdit&&b=="edit"){return e.fn.fmatter.defaultFormat(j,a)}else{if(!isEmpty(j)){return e.fmatter.util.DateFormat(i.srcformat,j,i.newformat,i)}else{return e.fn.fmatter.defaultFormat(j,a)}}};e.fn.fmatter.select=function(a,r,j,v){a=a+"";var c=false,w=[];if(!isUndefined(r.colModel.formatoptions)){c=r.colModel.formatoptions.value}else{if(!isUndefined(r.colModel.editoptions)){c=r.colModel.editoptions.value}}if(c){var s=r.colModel.editoptions.multiple===true?true:false,t=[],u;if(s){t=a.split(",");t=e.map(t,function(g){return e.trim(g)})}if(isString(c)){var i=c.split(";"),b=0;for(var x=0;x<i.length;x++){u=i[x].split(":");if(u.length>2){u[1]=jQuery.map(u,function(h,g){if(g>0){return h}}).join(":")}if(s){if(jQuery.inArray(u[0],t)>-1){w[b]=u[1];b++}}else{if(e.trim(u[0])==e.trim(a)){w[0]=u[1];break}}}}else{if(isObject(c)){if(s){w=jQuery.map(t,function(h,g){return c[h]})}else{w[0]=c[a]||""}}}}a=w.join(", ");return a==""?e.fn.fmatter.defaultFormat(a,r):a};e.fn.fmatter.rowactions=function(a,b,c,j){switch(c){case"edit":var i=function(){e("tr#"+a+" div.ui-inline-edit, tr#"+a+" div.ui-inline-del","#"+b).show();e("tr#"+a+" div.ui-inline-save, tr#"+a+" div.ui-inline-cancel","#"+b).hide()};e("#"+b).jqGrid("editRow",a,j,null,null,null,{oper:"edit"},i,null,i);e("tr#"+a+" div.ui-inline-edit, tr#"+a+" div.ui-inline-del","#"+b).hide();e("tr#"+a+" div.ui-inline-save, tr#"+a+" div.ui-inline-cancel","#"+b).show();break;case"save":e("#"+b).jqGrid("saveRow",a,null,null);e("tr#"+a+" div.ui-inline-edit, tr#"+a+" div.ui-inline-del","#"+b).show();e("tr#"+a+" div.ui-inline-save, tr#"+a+" div.ui-inline-cancel","#"+b).hide();break;case"cancel":e("#"+b).jqGrid("restoreRow",a);e("tr#"+a+" div.ui-inline-edit, tr#"+a+" div.ui-inline-del","#"+b).show();e("tr#"+a+" div.ui-inline-save, tr#"+a+" div.ui-inline-cancel","#"+b).hide();break}};e.fn.fmatter.actions=function(a,k,b){var l={keys:false,editbutton:true,delbutton:true};if(!isUndefined(k.colModel.formatoptions)){l=e.extend(l,k.colModel.formatoptions)}var m=k.rowId,n="",c;if(typeof(m)=="undefined"||isEmpty(m)){return""}if(l.editbutton){c="onclick=$.fn.fmatter.rowactions('"+m+"','"+k.gid+"','edit',"+l.keys+");";n=n+"<div style='margin-left:8px;'><div title='"+e.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+c+"><span class='ui-icon ui-icon-pencil'></span></div>"}if(l.delbutton){c="onclick=jQuery('#"+k.gid+"').jqGrid('delGridRow','"+m+"');";n=n+"<div title='"+e.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+c+"><span class='ui-icon ui-icon-trash'></span></div>"}c="onclick=$.fn.fmatter.rowactions('"+m+"','"+k.gid+"','save',false);";n=n+"<div title='"+e.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save'><span class='ui-icon ui-icon-disk' "+c+"></span></div>";c="onclick=$.fn.fmatter.rowactions('"+m+"','"+k.gid+"','cancel',false);";n=n+"<div title='"+e.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel'><span class='ui-icon ui-icon-cancel' "+c+"></span></div></div>";return n};e.unformat=function(c,t,w,q){var x,b=t.colModel.formatter,a=t.colModel.formatoptions||{},r,u=/([\.\*\_\'\(\)\{\}\+\?\\])/g;unformatFunc=t.colModel.unformat||(e.fn.fmatter[b]&&e.fn.fmatter[b].unformat);if(typeof unformatFunc!=="undefined"&&isFunction(unformatFunc)){x=unformatFunc(e(c).text(),t,c)}else{if(typeof b!=="undefined"&&isString(b)){var s=e.jgrid.formatter||{},v;switch(b){case"integer":a=e.extend({},s.integer,a);r=a.thousandsSeparator.replace(u,"\\$1");v=new RegExp(r,"g");x=e(c).text().replace(v,"");break;case"number":a=e.extend({},s.number,a);r=a.thousandsSeparator.replace(u,"\\$1");v=new RegExp(r,"g");x=e(c).text().replace(v,"").replace(a.decimalSeparator,".");break;case"currency":a=e.extend({},s.currency,a);r=a.thousandsSeparator.replace(u,"\\$1");v=new RegExp(r,"g");x=e(c).text().replace(v,"").replace(a.decimalSeparator,".").replace(a.prefix,"").replace(a.suffix,"");break;case"checkbox":var p=(t.colModel.editoptions)?t.colModel.editoptions.value.split(":"):["Yes","No"];x=e("input",c).attr("checked")?p[0]:p[1];break;case"select":x=e.unformat.select(c,t,w,q);break;case"actions":return"";default:x=e(c).text()}}}return x?x:q===true?e(c).text():e.jgrid.htmlDecode(e(c).html())};e.unformat.select=function(c,A,y,v){var B=[];var t=e(c).text();if(v===true){return t}var a=e.extend({},A.colModel.editoptions);if(a.value){var u=a.value,i=a.multiple===true?true:false,w=[],x;if(i){w=t.split(",");w=e.map(w,function(g){return e.trim(g)})}if(isString(u)){var z=u.split(";"),j=0;for(var b=0;b<z.length;b++){x=z[b].split(":");if(x.length>2){x[1]=jQuery.map(x,function(h,g){if(g>0){return h}}).join(":")}if(i){if(jQuery.inArray(x[1],w)>-1){B[j]=x[0];j++}}else{if(e.trim(x[1])==e.trim(t)){B[0]=x[0];break}}}}else{if(isObject(u)||e.isArray(u)){if(!i){w[0]=t}B=jQuery.map(w,function(g){var h;e.each(u,function(l,k){if(k==g){h=l;return false}});if(typeof(h)!="undefined"){return h}})}}return B.join(", ")}else{return t||""}};e.unformat.date=function(c,a){var b=e.jgrid.formatter.date||{};if(!isUndefined(a.formatoptions)){b=e.extend({},b,a.formatoptions)}if(!isEmpty(c)){return e.fmatter.util.DateFormat(b.newformat,c,b.srcformat,b)}else{return e.fn.fmatter.defaultFormat(c,a)}};function d(l,j,a,k,c){var b=j;if(e.fn.fmatter[l]){b=e.fn.fmatter[l](j,a,k,c)}return b}function f(a){if(window.console&&window.console.log){window.console.log(a)}}isValue=function(a){return(isObject(a)||isString(a)||isNumber(a)||isBoolean(a))};isBoolean=function(a){return typeof a==="boolean"};isNull=function(a){return a===null};isNumber=function(a){return typeof a==="number"&&isFinite(a)};isString=function(a){return typeof a==="string"};isEmpty=function(a){if(!isString(a)&&isValue(a)){return false}else{if(!isValue(a)){return true}}a=e.trim(a).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");return a===""};isUndefined=function(a){return typeof a==="undefined"};isObject=function(a){return(a&&(typeof a==="object"||isFunction(a)))||false};isFunction=function(a){return typeof a==="function"}})(jQuery);