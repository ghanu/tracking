(function(b){b.jgrid.extend({jqGridImport:function(a){a=b.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},a||{});return this.each(function(){var g=this;var i=function(e,r){var o=b(r.xmlGrid.config,e)[0];var c=b(r.xmlGrid.data,e)[0],q,p;if(xmlJsonClass.xml2json&&b.jgrid.parse){q=xmlJsonClass.xml2json(o," ");q=b.jgrid.parse(q);for(var d in q){if(q.hasOwnProperty(d)){p=q[d]}}if(c){var f=q.grid.datatype;q.grid.datatype="xmlstring";q.grid.datastr=e;b(g).jqGrid(p).jqGrid("setGridParam",{datatype:f})}else{b(g).jqGrid(p)}q=null;p=null}else{alert("xml2json or parse are not present")}};var h=function(n,e){if(n&&typeof n=="string"){var c=b.jgrid.parse(n);var d=c[e.jsonGrid.config];var m=c[e.jsonGrid.data];if(m){var f=d.datatype;d.datatype="jsonstring";d.datastr=m;b(g).jqGrid(d).jqGrid("setGridParam",{datatype:f})}else{b(g).jqGrid(d)}}};switch(a.imptype){case"xml":b.ajax(b.extend({url:a.impurl,type:a.mtype,data:a.impData,dataType:"xml",complete:function(d,c){if(c=="success"){i(d.responseXML,a);if(b.isFunction(a.importComplete)){a.importComplete(d)}}d=null}},a.ajaxOptions));break;case"xmlstring":if(a.impstring&&typeof a.impstring=="string"){var j=b.jgrid.stringToDoc(a.impstring);if(j){i(j,a);if(b.isFunction(a.importComplete)){a.importComplete(j)}a.impstring=null}j=null}break;case"json":b.ajax(b.extend({url:a.impurl,type:a.mtype,data:a.impData,dataType:"json",complete:function(d,c){if(c=="success"){h(d.responseText,a);if(b.isFunction(a.importComplete)){a.importComplete(d)}}d=null}},a.ajaxOptions));break;case"jsonstring":if(a.impstring&&typeof a.impstring=="string"){h(a.impstring,a);if(b.isFunction(a.importComplete)){a.importComplete(a.impstring)}a.impstring=null}break}})},jqGridExport:function(d){d=b.extend({exptype:"xmlstring",root:"grid",ident:"\t"},d||{});var a=null;this.each(function(){if(!this.grid){return}var c=b.extend({},b(this).jqGrid("getGridParam"));if(c.rownumbers){c.colNames.splice(0,1);c.colModel.splice(0,1)}if(c.multiselect){c.colNames.splice(0,1);c.colModel.splice(0,1)}if(c.subGrid){c.colNames.splice(0,1);c.colModel.splice(0,1)}c.knv=null;if(c.treeGrid){for(var f in c.treeReader){if(c.treeReader.hasOwnProperty(f)){c.colNames.splice(c.colNames.length-1);c.colModel.splice(c.colModel.length-1)}}}switch(d.exptype){case"xmlstring":a="<"+d.root+">"+xmlJsonClass.json2xml(c,d.ident)+"</"+d.root+">";break;case"jsonstring":a="{"+xmlJsonClass.toJson(c,d.root,d.ident)+"}";if(c.postData.filters!==undefined){a=a.replace(/filters":"/,'filters":');a=a.replace(/}]}"/,"}]}")}break}});return a},excelExport:function(a){a=b.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},a||{});return this.each(function(){if(!this.grid){return}var h;if(a.exptype=="remote"){var g=b.extend({},this.p.postData);g[a.oper]=a.tag;var f=jQuery.param(g);if(a.url.indexOf("?")!=-1){h=a.url+"&"+f}else{h=a.url+"?"+f}window.location=h}})}})})(jQuery);