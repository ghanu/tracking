(function(b){var a=null;b.jgrid.extend({searchGrid:function(c){c=b.extend({recreateFilter:false,drag:true,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:true,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,closeAfterSearch:false,closeAfterReset:false,closeOnEscape:false,multipleSearch:false,cloneSearchRowOnAdd:true,sopt:null,stringResult:undefined,onClose:null,useDataProxy:false,overlay:true},b.jgrid.search,c||{});return this.each(function(){var r=this;if(!r.grid){return}function t(y,A){var z=y.p.postData[A.sFilter];if(typeof(z)=="string"){z=b.jgrid.parse(z)}if(z){if(z.groupOp){y.SearchFilter.setGroupOp(z.groupOp)}if(z.rules){var j,x=0,k=z.rules.length,e=false;for(;x<k;x++){j=z.rules[x];if(j.field!==undefined&&j.op!==undefined&&j.data!==undefined){e=y.SearchFilter.setFilter({sfref:y.SearchFilter.$.find(".sf:last"),filter:b.extend({},j)});if(e){y.SearchFilter.add()}}}}}}if(b.fn.searchFilter){var d="fbox_"+r.p.id;if(c.recreateFilter===true){b("#"+d).remove()}if(b("#"+d).html()!=null){if(b.isFunction(c.beforeShowSearch)){c.beforeShowSearch(b("#"+d))}w();if(b.isFunction(c.afterShowSearch)){c.afterShowSearch(b("#"+d))}}else{var p=[],u=b("#"+r.p.id).jqGrid("getGridParam","colNames"),m=b("#"+r.p.id).jqGrid("getGridParam","colModel"),s=["eq","ne","lt","le","gt","ge","bw","bn","in","ni","ew","en","cn","nc"],g,l,f,n=[];if(c.sopt!==null){f=0;for(g=0;g<c.sopt.length;g++){if((l=b.inArray(c.sopt[g],s))!=-1){n[f]={op:c.sopt[g],text:c.odata[l]};f++}}}else{for(g=0;g<s.length;g++){n[g]={op:s[g],text:c.odata[g]}}}var o;b.each(m,function(y,D){var A=(typeof D.search==="undefined")?true:D.search,z=(D.hidden===true),k=b.extend({},{text:u[y],itemval:D.index||D.name},this.searchoptions),x=(k.searchhidden===true);if(typeof k.sopt!=="undefined"){f=0;k.ops=[];if(k.sopt.length>0){for(g=0;g<k.sopt.length;g++){if((l=b.inArray(k.sopt[g],s))!=-1){k.ops[f]={op:k.sopt[g],text:c.odata[l]};f++}}}}if(typeof(this.stype)==="undefined"){this.stype="text"}if(this.stype=="select"){if(k.dataUrl!==undefined){}else{var j;if(k.value){j=k.value}else{if(this.editoptions){j=this.editoptions.value}}if(j){k.dataValues=[];if(typeof(j)==="string"){var e=j.split(";"),C;for(g=0;g<e.length;g++){C=e[g].split(":");k.dataValues[g]={value:C[0],text:C[1]}}}else{if(typeof(j)==="object"){g=0;for(var B in j){if(j.hasOwnProperty(B)){k.dataValues[g]={value:B,text:j[B]};g++}}}}}}}if((x&&A)||(A&&!z)){p.push(k)}});if(p.length>0){b("<div id='"+d+"' role='dialog' tabindex='-1'></div>").insertBefore("#gview_"+r.p.id);if(c.stringResult===undefined){c.stringResult=c.multipleSearch}r.SearchFilter=b("#"+d).searchFilter(p,{groupOps:c.groupOps,operators:n,onClose:v,resetText:c.Reset,searchText:c.Find,windowTitle:c.caption,rulesText:c.rulesText,matchText:c.matchText,onSearch:q,onReset:i,stringResult:c.stringResult,ajaxSelectOptions:b.extend({},b.jgrid.ajaxOptions,r.p.ajaxSelectOptions||{}),clone:c.cloneSearchRowOnAdd});b(".ui-widget-overlay","#"+d).remove();if(r.p.direction=="rtl"){b(".ui-closer","#"+d).css("float","left")}if(c.drag===true){b("#"+d+" table thead tr:first td:first").css("cursor","move");if(jQuery.fn.jqDrag){b("#"+d).jqDrag(b("#"+d+" table thead tr:first td:first"))}else{try{b("#"+d).draggable({handle:b("#"+d+" table thead tr:first td:first")})}catch(h){}}}if(c.multipleSearch===false){b(".ui-del, .ui-add, .ui-del, .ui-add-last, .matchText, .rulesText","#"+d).hide();b("select[name='groupOp']","#"+d).hide()}if(c.multipleSearch===true&&c.loadDefaults===true){t(r,c)}if(b.isFunction(c.onInitializeSearch)){c.onInitializeSearch(b("#"+d))}if(b.isFunction(c.beforeShowSearch)){c.beforeShowSearch(b("#"+d))}w();if(b.isFunction(c.afterShowSearch)){c.afterShowSearch(b("#"+d))}if(c.closeOnEscape===true){b("#"+d).keydown(function(e){if(e.which==27){v(b("#"+d))}})}}}}function q(x){var e=(x!==undefined),k=b("#"+r.p.id),j={};if(c.multipleSearch===false){j[c.sField]=x.rules[0].field;j[c.sValue]=x.rules[0].data;j[c.sOper]=x.rules[0].op}else{j[c.sFilter]=x}k[0].p.search=e;b.extend(k[0].p.postData,j);k.trigger("reloadGrid",[{page:1}]);if(c.closeAfterSearch){v(b("#"+d))}}function i(j){var e=j&&j.hasOwnProperty("reload")?j.reload:true;grid=b("#"+r.p.id),sdata=[];grid[0].p.search=false;if(c.multipleSearch===false){sdata[c.sField]=sdata[c.sValue]=sdata[c.sOper]=""}else{sdata[c.sFilter]=""}b.extend(grid[0].p.postData,sdata);if(e){grid.trigger("reloadGrid",[{page:1}])}if(c.closeAfterReset){v(b("#"+d))}}function v(e){if(c.onClose){var j=c.onClose(e);if(typeof j=="boolean"&&!j){return}}e.hide();if(c.overlay===true){b(".jqgrid-overlay:first","#gbox_"+r.p.id).hide()}}function w(){var k=b(".ui-searchFilter").length;if(k>1){var j=b("#"+d).css("zIndex");b("#"+d).css({zIndex:parseInt(j,10)+k})}b("#"+d).show();if(c.overlay===true){b(".jqgrid-overlay:first","#gbox_"+r.p.id).show()}try{b(":input:visible","#"+d)[0].focus()}catch(e){}}})},editGridRow:function(c,d){d=b.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:false,drag:true,resize:true,url:null,mtype:"POST",clearAfterAdd:true,closeAfterEdit:false,reloadAfterSubmit:true,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:false,jqModal:true,closeOnEscape:false,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[false,13],navkeys:[false,38,40],checkOnSubmit:false,checkOnUpdate:false,_savedData:{},processing:false,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:true},b.jgrid.edit,d||{});a=d;return this.each(function(){var o=this;if(!o.grid||!c){return}var M=o.p.id,I="FrmGrid_"+M,E="TblGrid_"+M,s={themodal:"editmod"+M,modalhead:"edithd"+M,modalcontent:"editcnt"+M,scrollelm:I},N=b.isFunction(a.beforeShowForm)?a.beforeShowForm:false,g=b.isFunction(a.afterShowForm)?a.afterShowForm:false,X=b.isFunction(a.beforeInitData)?a.beforeInitData:false,y=b.isFunction(a.onInitializeForm)?a.onInitializeForm:false,S=null,T=1,A=0,e,O,P,j,R,L;if(c=="new"){c="_empty";d.caption=d.addCaption}else{d.caption=d.editCaption}if(d.recreateForm===true&&b("#"+s.themodal).html()!=null){b("#"+s.themodal).remove()}var u=true;if(d.checkOnUpdate&&d.jqModal&&!d.modal){u=false}if(b("#"+s.themodal).html()!=null){b(".ui-jqdialog-title","#"+s.modalhead).html(d.caption);b("#FormError","#"+E).hide();if(a.topinfo){b(".topinfo","#"+E+"_2").html(a.topinfo);b(".tinfo","#"+E+"_2").show()}else{b(".tinfo","#"+E+"_2").hide()}if(a.bottominfo){b(".bottominfo","#"+E+"_2").html(a.bottominfo);b(".binfo","#"+E+"_2").show()}else{b(".binfo","#"+E+"_2").hide()}if(X){X(b("#"+I))}x(c,o,I);if(c=="_empty"||!a.viewPagerButtons){b("#pData, #nData","#"+E+"_2").hide()}else{b("#pData, #nData","#"+E+"_2").show()}if(a.processing===true){a.processing=false;b("#sData","#"+E+"_2").removeClass("ui-state-active")}if(b("#"+I).data("disabled")===true){b(".confirm","#"+s.themodal).hide();b("#"+I).data("disabled",false)}if(N){N(b("#"+I))}b("#"+s.themodal).data("onClose",a.onClose);viewModal("#"+s.themodal,{gbox:"#gbox_"+M,jqm:d.jqModal,jqM:false,closeoverlay:u,modal:d.modal});if(!u){b(".jqmOverlay").click(function(){if(!q()){return false}hideModal("#"+s.themodal,{gb:"#gbox_"+M,jqm:d.jqModal,onClose:a.onClose});return false})}if(g){g(b("#"+I))}}else{b(o.p.colModel).each(function(Y){var Z=this.formoptions;T=Math.max(T,Z?Z.colpos||0:0);A=Math.max(A,Z?Z.rowpos||0:0)});var B=isNaN(d.dataheight)?d.dataheight:d.dataheight+"px";var W,m=b("<form name='FormPost' id='"+I+"' class='FormGrid' onSubmit='return false;' style='width:100%;overflow:auto;position:relative;height:"+B+";'></form>").data("disabled",false),K=b("<table id='"+E+"' class='EditTable' cellspacing='0' cellpading='0' border='0'><tbody></tbody></table>");b(m).append(K);W=b("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+(T*2)+"'></td></tr>");W[0].rp=0;b(K).append(W);W=b("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+(T*2)+"'>"+a.topinfo+"</td></tr>");W[0].rp=0;b(K).append(W);if(X){X(b("#"+I))}var p=o.p.direction=="rtl"?true:false,l=p?"nData":"pData",n=p?"pData":"nData",J=C(c,o,K,T),v="<a href='javascript:void(0)' id='"+l+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></div>",w="<a href='javascript:void(0)' id='"+n+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></div>",r="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default ui-corner-all'>"+d.bSubmit+"</a>",D="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+d.bCancel+"</a>";var i="<table border='0' class='EditTable' id='"+E+"_2'><tbody><tr id='Act_Buttons'><td class='navButton ui-widget-content'>"+(p?w+v:v+w)+"</td><td class='EditButton ui-widget-content'>"+r+D+"</td></tr>";i+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+a.bottominfo+"</td></tr>";i+="</tbody></table>";if(A>0){var H=[];b.each(b(K)[0].rows,function(Y,Z){H[Y]=Z});H.sort(function(Z,Y){if(Z.rp>Y.rp){return 1}if(Z.rp<Y.rp){return -1}return 0});b.each(H,function(Y,Z){b("tbody",K).append(Z)})}d.gbox="#gbox_"+M;var z=false;if(d.closeOnEscape===true){d.closeOnEscape=false;z=true}var h=b("<span></span>").append(m).append(i);createModal(s,h,d,"#gview_"+o.p.id,b("#gbox_"+o.p.id)[0]);if(p){b("#pData, #nData","#"+E+"_2").css("float","right");b(".EditButton","#"+E+"_2").css("text-align","left")}if(a.topinfo){b(".tinfo","#"+E+"_2").show()}if(a.bottominfo){b(".binfo","#"+E+"_2").show()}h=null;i=null;b("#"+s.themodal).keydown(function(Y){var Z=Y.target;if(b("#"+I).data("disabled")===true){return false}if(a.savekey[0]===true&&Y.which==a.savekey[1]){if(Z.tagName!="TEXTAREA"){b("#sData","#"+E+"_2").trigger("click");return false}}if(Y.which===27){if(!q()){return false}if(z){hideModal(this,{gb:d.gbox,jqm:d.jqModal,onClose:a.onClose})}return false}if(a.navkeys[0]===true){if(b("#id_g","#"+E).val()=="_empty"){return true}if(Y.which==a.navkeys[1]){b("#pData","#"+E+"_2").trigger("click");return false}if(Y.which==a.navkeys[2]){b("#nData","#"+E+"_2").trigger("click");return false}}});if(d.checkOnUpdate){b("a.ui-jqdialog-titlebar-close span","#"+s.themodal).removeClass("jqmClose");b("a.ui-jqdialog-titlebar-close","#"+s.themodal).unbind("click").click(function(){if(!q()){return false}hideModal("#"+s.themodal,{gb:"#gbox_"+M,jqm:d.jqModal,onClose:a.onClose});return false})}d.saveicon=b.extend([true,"left","ui-icon-disk"],d.saveicon);d.closeicon=b.extend([true,"left","ui-icon-close"],d.closeicon);if(d.saveicon[0]===true){b("#sData","#"+E+"_2").addClass(d.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+d.saveicon[2]+"'></span>")}if(d.closeicon[0]===true){b("#cData","#"+E+"_2").addClass(d.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+d.closeicon[2]+"'></span>")}if(a.checkOnSubmit||a.checkOnUpdate){r="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+d.bYes+"</a>";w="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+d.bNo+"</a>";D="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+d.bExit+"</a>";var Q,f=d.zIndex||999;f++;if(b.browser.msie&&b.browser.version==6){Q='<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>'}else{Q=""}b("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+f+";display:none;'>&#160;"+Q+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(f+1)+"'>"+d.saveData+"<br/><br/>"+r+w+D+"</div>").insertAfter("#"+I);b("#sNew","#"+s.themodal).click(function(){t();b("#"+I).data("disabled",false);b(".confirm","#"+s.themodal).hide();return false});b("#nNew","#"+s.themodal).click(function(){b(".confirm","#"+s.themodal).hide();b("#"+I).data("disabled",false);setTimeout(function(){b(":input","#"+I)[0].focus()},0);return false});b("#cNew","#"+s.themodal).click(function(){b(".confirm","#"+s.themodal).hide();b("#"+I).data("disabled",false);hideModal("#"+s.themodal,{gb:"#gbox_"+M,jqm:d.jqModal,onClose:a.onClose});return false})}if(y){y(b("#"+I))}if(c=="_empty"||!a.viewPagerButtons){b("#pData,#nData","#"+E+"_2").hide()}else{b("#pData,#nData","#"+E+"_2").show()}if(N){N(b("#"+I))}b("#"+s.themodal).data("onClose",a.onClose);viewModal("#"+s.themodal,{gbox:"#gbox_"+M,jqm:d.jqModal,closeoverlay:u,modal:d.modal});if(!u){b(".jqmOverlay").click(function(){if(!q()){return false}hideModal("#"+s.themodal,{gb:"#gbox_"+M,jqm:d.jqModal,onClose:a.onClose});return false})}if(g){g(b("#"+I))}b(".fm-button","#"+s.themodal).hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")});b("#sData","#"+E+"_2").click(function(Y){O={};j={};b("#FormError","#"+E).hide();F();if(O[o.p.id+"_id"]=="_empty"){t()}else{if(d.checkOnSubmit===true){R=b.extend({},O,j);L=U(R,a._savedData);if(L){b("#"+I).data("disabled",true);b(".confirm","#"+s.themodal).show()}else{t()}}else{t()}}return false});b("#cData","#"+E+"_2").click(function(Y){if(!q()){return false}hideModal("#"+s.themodal,{gb:"#gbox_"+M,jqm:d.jqModal,onClose:a.onClose});return false});b("#nData","#"+E+"_2").click(function(Y){if(!q()){return false}b("#FormError","#"+E).hide();var Z=G();Z[0]=parseInt(Z[0],10);if(Z[0]!=-1&&Z[1][Z[0]+1]){if(b.isFunction(d.onclickPgButtons)){d.onclickPgButtons("next",b("#"+I),Z[1][Z[0]])}x(Z[1][Z[0]+1],o,I);b(o).jqGrid("setSelection",Z[1][Z[0]+1]);if(b.isFunction(d.afterclickPgButtons)){d.afterclickPgButtons("next",b("#"+I),Z[1][Z[0]+1])}V(Z[0]+1,Z[1].length-1)}return false});b("#pData","#"+E+"_2").click(function(Z){if(!q()){return false}b("#FormError","#"+E).hide();var Y=G();if(Y[0]!=-1&&Y[1][Y[0]-1]){if(b.isFunction(d.onclickPgButtons)){d.onclickPgButtons("prev",b("#"+I),Y[1][Y[0]])}x(Y[1][Y[0]-1],o,I);b(o).jqGrid("setSelection",Y[1][Y[0]-1]);if(b.isFunction(d.afterclickPgButtons)){d.afterclickPgButtons("prev",b("#"+I),Y[1][Y[0]-1])}V(Y[0]-1,Y[1].length-1)}return false})}var k=G();V(k[0],k[1].length-1);function V(Z,aa,Y){if(Z===0){b("#pData","#"+E+"_2").addClass("ui-state-disabled")}else{b("#pData","#"+E+"_2").removeClass("ui-state-disabled")}if(Z==aa){b("#nData","#"+E+"_2").addClass("ui-state-disabled")}else{b("#nData","#"+E+"_2").removeClass("ui-state-disabled")}}function G(){var Z=b(o).jqGrid("getDataIDs"),Y=b("#id_g","#"+E).val(),aa=b.inArray(Y,Z);return[aa,Z]}function q(){var Y=true;b("#FormError","#"+E).hide();if(a.checkOnUpdate){O={};j={};F();R=b.extend({},O,j);L=U(R,a._savedData);if(L){b("#"+I).data("disabled",true);b(".confirm","#"+s.themodal).show();Y=false}}return Y}function F(){b(".FormElement","#"+E).each(function(Z){var ad=b(".customelement",this);if(ad.length){var ab=ad[0],Y=b(ab).attr("name");b.each(o.p.colModel,function(ae,ag){if(this.name==Y&&this.editoptions&&b.isFunction(this.editoptions.custom_value)){try{O[Y]=this.editoptions.custom_value(b("#"+Y,"#"+E),"get");if(O[Y]===undefined){throw"e1"}}catch(af){if(af=="e1"){info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{info_dialog(jQuery.jgrid.errors.errcap,af.message,jQuery.jgrid.edit.bClose)}}return true}})}else{switch(b(this).get(0).type){case"checkbox":if(b(this).attr("checked")){O[this.name]=b(this).val()}else{var aa=b(this).attr("offval");O[this.name]=aa}break;case"select-one":O[this.name]=b("option:selected",this).val();j[this.name]=b("option:selected",this).text();break;case"select-multiple":O[this.name]=b(this).val();if(O[this.name]){O[this.name]=O[this.name].join(",")}else{O[this.name]=""}var ac=[];b("option:selected",this).each(function(ae,af){ac[ae]=b(af).text()});j[this.name]=ac.join(",");break;case"password":case"text":case"textarea":case"button":O[this.name]=b(this).val();break}if(o.p.autoencode){O[this.name]=b.jgrid.htmlEncode(O[this.name])}}});return true}function C(af,am,aj,ah){var ac,an,ae,ai=0,al,ab,ad,Y=[],ag=false,ao="<td class='CaptionTD ui-widget-content'>&#160;</td><td class='DataTD ui-widget-content' style='white-space:pre'>&#160;</td>",aa="";for(var ak=1;ak<=ah;ak++){aa+=ao}if(af!="_empty"){ag=b(am).jqGrid("getInd",af)}b(am.p.colModel).each(function(ar){ac=this.name;if(this.editrules&&this.editrules.edithidden===true){an=false}else{an=this.hidden===true?true:false}ab=an?"style='display:none'":"";if(ac!=="cb"&&ac!=="subgrid"&&this.editable===true&&ac!=="rn"){if(ag===false){al=""}else{if(ac==am.p.ExpandColumn&&am.p.treeGrid===true){al=b("td:eq("+ar+")",am.rows[ag]).text()}else{try{al=b.unformat(b("td:eq("+ar+")",am.rows[ag]),{rowId:af,colModel:this},ar)}catch(au){al=b("td:eq("+ar+")",am.rows[ag]).html()}}}var aq=b.extend({},this.editoptions||{},{id:ac,name:ac}),aw=b.extend({},{elmprefix:"",elmsuffix:"",rowabove:false,rowcontent:""},this.formoptions||{}),at=parseInt(aw.rowpos,10)||ai+1,av=parseInt((parseInt(aw.colpos,10)||1)*2,10);if(af=="_empty"&&aq.defaultValue){al=b.isFunction(aq.defaultValue)?aq.defaultValue():aq.defaultValue}if(!this.edittype){this.edittype="text"}if(o.p.autoencode){al=b.jgrid.htmlDecode(al)}ad=createEl(this.edittype,aq,al,false,b.extend({},b.jgrid.ajaxOptions,am.p.ajaxSelectOptions||{}));if(al==""&&this.edittype=="checkbox"){al=b(ad).attr("offval")}if(al==""&&this.edittype=="select"){al=b("option:eq(0)",ad).text()}if(a.checkOnSubmit||a.checkOnUpdate){a._savedData[ac]=al}b(ad).addClass("FormElement");ae=b(aj).find("tr[rowpos="+at+"]");if(aw.rowabove){var ap=b("<tr><td class='contentinfo' colspan='"+(ah*2)+"'>"+aw.rowcontent+"</td></tr>");b(aj).append(ap);ap[0].rp=at}if(ae.length===0){ae=b("<tr "+ab+" rowpos='"+at+"'></tr>").addClass("FormData").attr("id","tr_"+ac);b(ae).append(aa);b(aj).append(ae);ae[0].rp=at}b("td:eq("+(av-2)+")",ae[0]).html(typeof aw.label==="undefined"?am.p.colNames[ar]:aw.label);b("td:eq("+(av-1)+")",ae[0]).append(aw.elmprefix).append(ad).append(aw.elmsuffix);Y[ai]=ar;ai++}});if(ai>0){var Z=b("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(ah*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+am.p.id+"_id' value='"+af+"'/></td></tr>");Z[0].rp=ai+999;b(aj).append(Z);if(a.checkOnSubmit||a.checkOnUpdate){a._savedData[am.p.id+"_id"]=af}}return Y}function x(ae,Z,ah){var ad,ai=0,aa,Y,af,aj,ab;if(a.checkOnSubmit||a.checkOnUpdate){a._savedData={};a._savedData[Z.p.id+"_id"]=ae}var ac=Z.p.colModel;if(ae=="_empty"){b(ac).each(function(ak){ad=this.name;af=b.extend({},this.editoptions||{});Y=b("#"+b.jgrid.jqID(ad),"#"+ah);if(Y[0]!=null){aj="";if(af.defaultValue){aj=b.isFunction(af.defaultValue)?af.defaultValue():af.defaultValue;if(Y[0].type=="checkbox"){ab=aj.toLowerCase();if(ab.search(/(false|0|no|off|undefined)/i)<0&&ab!==""){Y[0].checked=true;Y[0].defaultChecked=true;Y[0].value=aj}else{Y.attr({checked:"",defaultChecked:""})}}else{Y.val(aj)}}else{if(Y[0].type=="checkbox"){Y[0].checked=false;Y[0].defaultChecked=false;aj=b(Y).attr("offval")}else{if(Y[0].type&&Y[0].type.substr(0,6)=="select"){Y[0].selectedIndex=0}else{Y.val(aj)}}}if(a.checkOnSubmit===true||a.checkOnUpdate){a._savedData[ad]=aj}}});b("#id_g","#"+ah).val(ae);return}var ag=b(Z).jqGrid("getInd",ae,true);if(!ag){return}b("td",ag).each(function(an){ad=ac[an].name;if(ad!=="cb"&&ad!=="subgrid"&&ad!=="rn"&&ac[an].editable===true){if(ad==Z.p.ExpandColumn&&Z.p.treeGrid===true){aa=b(this).text()}else{try{aa=b.unformat(this,{rowId:ae,colModel:ac[an]},an)}catch(am){aa=b(this).html()}}if(o.p.autoencode){aa=b.jgrid.htmlDecode(aa)}if(a.checkOnSubmit===true||a.checkOnUpdate){a._savedData[ad]=aa}ad=b.jgrid.jqID(ad);switch(ac[an].edittype){case"password":case"text":case"button":case"image":b("#"+ad,"#"+ah).val(aa);break;case"textarea":if(aa=="&nbsp;"||aa=="&#160;"||(aa.length==1&&aa.charCodeAt(0)==160)){aa=""}b("#"+ad,"#"+ah).val(aa);break;case"select":var al=aa.split(",");al=b.map(al,function(aq){return b.trim(aq)});b("#"+ad+" option","#"+ah).each(function(aq){if(!ac[an].editoptions.multiple&&(al[0]==b.trim(b(this).text())||al[0]==b.trim(b(this).val()))){this.selected=true}else{if(ac[an].editoptions.multiple){if(b.inArray(b.trim(b(this).text()),al)>-1||b.inArray(b.trim(b(this).val()),al)>-1){this.selected=true}else{this.selected=false}}else{this.selected=false}}});break;case"checkbox":aa=aa+"";if(ac[an].editoptions&&ac[an].editoptions.value){var ak=ac[an].editoptions.value.split(":");if(ak[0]==aa){b("#"+ad,"#"+ah).attr("checked",true);b("#"+ad,"#"+ah).attr("defaultChecked",true)}else{b("#"+ad,"#"+ah).attr("checked",false);b("#"+ad,"#"+ah).attr("defaultChecked","")}}else{aa=aa.toLowerCase();if(aa.search(/(false|0|no|off|undefined)/i)<0&&aa!==""){b("#"+ad,"#"+ah).attr("checked",true);b("#"+ad,"#"+ah).attr("defaultChecked",true)}else{b("#"+ad,"#"+ah).attr("checked",false);b("#"+ad,"#"+ah).attr("defaultChecked","")}}break;case"custom":try{if(ac[an].editoptions&&b.isFunction(ac[an].editoptions.custom_value)){var ap=ac[an].editoptions.custom_value(b("#"+ad,"#"+ah),"set",aa)}else{throw"e1"}}catch(ao){if(ao=="e1"){info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}else{info_dialog(jQuery.jgrid.errors.errcap,ao.message,jQuery.jgrid.edit.bClose)}}break}ai++}});if(ai>0){b("#id_g","#"+E).val(ae)}}function t(){var Z,Y=[true,"",""],ab={},ae=o.p.prmNames,ag,ad;if(b.isFunction(a.beforeCheckValues)){var af=a.beforeCheckValues(O,b("#"+I),O[o.p.id+"_id"]=="_empty"?ae.addoper:ae.editoper);if(af&&typeof(af)==="object"){O=af}}for(var aa in O){if(O.hasOwnProperty(aa)){Y=checkValues(O[aa],aa,o);if(Y[0]===false){break}}}if(Y[0]){if(b.isFunction(a.onclickSubmit)){ab=a.onclickSubmit(a,O)||{}}if(b.isFunction(a.beforeSubmit)){Y=a.beforeSubmit(O,b("#"+I))}}if(Y[0]&&!a.processing){a.processing=true;b("#sData","#"+E+"_2").addClass("ui-state-active");ad=ae.oper;ag=ae.id;O[ad]=(b.trim(O[o.p.id+"_id"])=="_empty")?ae.addoper:ae.editoper;if(O[ad]!=ae.addoper){O[ag]=O[o.p.id+"_id"]}else{if(O[ag]===undefined){O[ag]=O[o.p.id+"_id"]}}delete O[o.p.id+"_id"];O=b.extend(O,a.editData,ab);var ac=b.extend({url:a.url?a.url:b(o).jqGrid("getGridParam","editurl"),type:a.mtype,data:b.isFunction(a.serializeEditData)?a.serializeEditData(O):O,complete:function(aj,ah){if(ah!="success"){Y[0]=false;if(b.isFunction(a.errorTextFormat)){Y[1]=a.errorTextFormat(aj)}else{Y[1]=ah+" Status: '"+aj.statusText+"'. Error code: "+aj.status}}else{if(b.isFunction(a.afterSubmit)){Y=a.afterSubmit(aj,O)}}if(Y[0]===false){b("#FormError>td","#"+E).html(Y[1]);b("#FormError","#"+E).show()}else{b.each(o.p.colModel,function(al,an){if(j[this.name]&&this.formatter&&this.formatter=="select"){try{delete j[this.name]}catch(am){}}});O=b.extend(O,j);if(o.p.autoencode){b.each(O,function(am,al){O[am]=b.jgrid.htmlDecode(al)})}a.reloadAfterSubmit=a.reloadAfterSubmit&&o.p.datatype!="local";if(O[ad]==ae.addoper){if(!Y[2]){Y[2]=(parseInt(o.p.records,10)+1)+""}O[ag]=Y[2];if(a.closeAfterAdd){if(a.reloadAfterSubmit){b(o).trigger("reloadGrid")}else{b(o).jqGrid("addRowData",Y[2],O,d.addedrow);b(o).jqGrid("setSelection",Y[2])}hideModal("#"+s.themodal,{gb:"#gbox_"+M,jqm:d.jqModal,onClose:a.onClose})}else{if(a.clearAfterAdd){if(a.reloadAfterSubmit){b(o).trigger("reloadGrid")}else{b(o).jqGrid("addRowData",Y[2],O,d.addedrow)}x("_empty",o,I)}else{if(a.reloadAfterSubmit){b(o).trigger("reloadGrid")}else{b(o).jqGrid("addRowData",Y[2],O,d.addedrow)}}}}else{if(a.reloadAfterSubmit){b(o).trigger("reloadGrid");if(!a.closeAfterEdit){setTimeout(function(){b(o).jqGrid("setSelection",O[ag])},1000)}}else{if(o.p.treeGrid===true){b(o).jqGrid("setTreeRow",O[ag],O)}else{b(o).jqGrid("setRowData",O[ag],O)}}if(a.closeAfterEdit){hideModal("#"+s.themodal,{gb:"#gbox_"+M,jqm:d.jqModal,onClose:a.onClose})}}if(b.isFunction(a.afterComplete)){Z=aj;setTimeout(function(){a.afterComplete(Z,O,b("#"+I));Z=null},500)}}a.processing=false;if(a.checkOnSubmit||a.checkOnUpdate){b("#"+I).data("disabled",false);if(a._savedData[o.p.id+"_id"]!="_empty"){for(var ai in a._savedData){if(O[ai]){a._savedData[ai]=O[ai]}}}}b("#sData","#"+E+"_2").removeClass("ui-state-active");try{b(":input:visible","#"+I)[0].focus()}catch(ak){}},error:function(ai,aj,ah){b("#FormError>td","#"+E).html(aj+" : "+ah);b("#FormError","#"+E).show();a.processing=false;b("#"+I).data("disabled",false);b("#sData","#"+E+"_2").removeClass("ui-state-active")}},b.jgrid.ajaxOptions,a.ajaxEditOptions);if(!ac.url&&!a.useDataProxy){if(b.isFunction(o.p.dataProxy)){a.useDataProxy=true}else{Y[0]=false;Y[1]+=" "+b.jgrid.errors.nourl}}if(Y[0]){if(a.useDataProxy){o.p.dataProxy.call(o,ac,"set_"+o.p.id)}else{b.ajax(ac)}}}if(Y[0]===false){b("#FormError>td","#"+E).html(Y[1]);b("#FormError","#"+E).show()}}function U(ab,Y){var Z=false,aa;for(aa in ab){if(ab[aa]!=Y[aa]){Z=true;break}}return Z}})},viewGridRow:function(c,d){d=b.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:false,drag:true,resize:true,jqModal:true,closeOnEscape:false,labelswidth:"30%",closeicon:[],navkeys:[false,38,40],onClose:null,beforeShowForm:null,viewPagerButtons:true},b.jgrid.view,d||{});return this.each(function(){var v=this;if(!v.grid||!c){return}if(!d.imgpath){d.imgpath=v.p.imgpath}var h=v.p.id,E="ViewGrid_"+h,j="ViewTbl_"+h,s={themodal:"viewmod"+h,modalhead:"viewhd"+h,modalcontent:"viewcnt"+h,scrollelm:E},o=1,k=0;if(b("#"+s.themodal).html()!=null){b(".ui-jqdialog-title","#"+s.modalhead).html(d.caption);b("#FormError","#"+j).hide();B(c,v);if(b.isFunction(d.beforeShowForm)){d.beforeShowForm(b("#"+E))}viewModal("#"+s.themodal,{gbox:"#gbox_"+h,jqm:d.jqModal,jqM:false,modal:d.modal});z()}else{b(v.p.colModel).each(function(F){var G=this.formoptions;o=Math.max(o,G?G.colpos||0:0);k=Math.max(k,G?G.rowpos||0:0)});var w=isNaN(d.dataheight)?d.dataheight:d.dataheight+"px";var u,i=b("<form name='FormPost' id='"+E+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+w+";'></form>"),A=b("<table id='"+j+"' class='EditTable' cellspacing='1' cellpading='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");b(i).append(A);var t=C(c,v,A,o),x=v.p.direction=="rtl"?true:false,p=x?"nData":"pData",l=x?"pData":"nData",n="<a href='javascript:void(0)' id='"+p+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></div>",r="<a href='javascript:void(0)' id='"+l+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></div>",m="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+d.bClose+"</a>";if(k>0){var y=[];b.each(b(A)[0].rows,function(F,G){y[F]=G});y.sort(function(G,F){if(G.rp>F.rp){return 1}if(G.rp<F.rp){return -1}return 0});b.each(y,function(F,G){b("tbody",A).append(G)})}d.gbox="#gbox_"+h;var f=false;if(d.closeOnEscape===true){d.closeOnEscape=false;f=true}var g=b("<span></span>").append(i).append("<table border='0' class='EditTable' id='"+j+"_2'><tbody><tr id='Act_Buttons'><td class='navButton ui-widget-content' width='"+d.labelswidth+"'>"+(x?r+n:n+r)+"</td><td class='EditButton ui-widget-content'>"+m+"</td></tr></tbody></table>");createModal(s,g,d,"#gview_"+v.p.id,b("#gview_"+v.p.id)[0]);if(x){b("#pData, #nData","#"+j+"_2").css("float","right");b(".EditButton","#"+j+"_2").css("text-align","left")}if(!d.viewPagerButtons){b("#pData, #nData","#"+j+"_2").hide()}g=null;b("#"+s.themodal).keydown(function(F){if(F.which===27){if(f){hideModal(this,{gb:d.gbox,jqm:d.jqModal,onClose:d.onClose})}return false}if(d.navkeys[0]===true){if(F.which===d.navkeys[1]){b("#pData","#"+j+"_2").trigger("click");return false}if(F.which===d.navkeys[2]){b("#nData","#"+j+"_2").trigger("click");return false}}});d.closeicon=b.extend([true,"left","ui-icon-close"],d.closeicon);if(d.closeicon[0]===true){b("#cData","#"+j+"_2").addClass(d.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+d.closeicon[2]+"'></span>")}if(b.isFunction(d.beforeShowForm)){d.beforeShowForm(b("#"+E))}viewModal("#"+s.themodal,{gbox:"#gbox_"+h,jqm:d.jqModal,modal:d.modal});b(".fm-button:not(.ui-state-disabled)","#"+j+"_2").hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")});z();b("#cData","#"+j+"_2").click(function(F){hideModal("#"+s.themodal,{gb:"#gbox_"+h,jqm:d.jqModal,onClose:d.onClose});return false});b("#nData","#"+j+"_2").click(function(F){b("#FormError","#"+j).hide();var G=q();G[0]=parseInt(G[0],10);if(G[0]!=-1&&G[1][G[0]+1]){if(b.isFunction(d.onclickPgButtons)){d.onclickPgButtons("next",b("#"+E),G[1][G[0]])}B(G[1][G[0]+1],v);b(v).jqGrid("setSelection",G[1][G[0]+1]);if(b.isFunction(d.afterclickPgButtons)){d.afterclickPgButtons("next",b("#"+E),G[1][G[0]+1])}D(G[0]+1,G[1].length-1)}z();return false});b("#pData","#"+j+"_2").click(function(G){b("#FormError","#"+j).hide();var F=q();if(F[0]!=-1&&F[1][F[0]-1]){if(b.isFunction(d.onclickPgButtons)){d.onclickPgButtons("prev",b("#"+E),F[1][F[0]])}B(F[1][F[0]-1],v);b(v).jqGrid("setSelection",F[1][F[0]-1]);if(b.isFunction(d.afterclickPgButtons)){d.afterclickPgButtons("prev",b("#"+E),F[1][F[0]-1])}D(F[0]-1,F[1].length-1)}z();return false})}function z(){if(d.closeOnEscape===true||d.navkeys[0]===true){setTimeout(function(){b(".ui-jqdialog-titlebar-close","#"+s.modalhead).focus()},0)}}var e=q();D(e[0],e[1].length-1);function D(G,H,F){if(G===0){b("#pData","#"+j+"_2").addClass("ui-state-disabled")}else{b("#pData","#"+j+"_2").removeClass("ui-state-disabled")}if(G==H){b("#nData","#"+j+"_2").addClass("ui-state-disabled")}else{b("#nData","#"+j+"_2").removeClass("ui-state-disabled")}}function q(){var G=b(v).jqGrid("getDataIDs"),F=b("#id_g","#"+j).val(),H=b.inArray(F,G);return[H,G]}function C(O,Z,X,Q){var J,M,aa,T,H,ad=0,S,V,F=[],Y=false,U="<td class='CaptionTD form-view-label ui-widget-content' width='"+d.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",W="",K="<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>",P=["integer","number","currency"],ac=0,ab=0,L,I,R;for(var N=1;N<=Q;N++){W+=N==1?U:K}b(Z.p.colModel).each(function(ae){if(this.editrules&&this.editrules.edithidden===true){M=false}else{M=this.hidden===true?true:false}if(!M&&this.align==="right"){if(this.formatter&&b.inArray(this.formatter,P)!==-1){ac=Math.max(ac,parseInt(this.width,10))}else{ab=Math.max(ab,parseInt(this.width,10))}}});L=ac!==0?ac:ab!==0?ab:0;Y=b(Z).jqGrid("getInd",O);b(Z.p.colModel).each(function(aj){J=this.name;I=false;if(this.editrules&&this.editrules.edithidden===true){M=false}else{M=this.hidden===true?true:false}V=M?"style='display:none'":"";R=(typeof this.viewable!="boolean")?true:this.viewable;if(J!=="cb"&&J!=="subgrid"&&J!=="rn"&&R){if(Y===false){S=""}else{if(J==Z.p.ExpandColumn&&Z.p.treeGrid===true){S=b("td:eq("+aj+")",Z.rows[Y]).text()}else{S=b("td:eq("+aj+")",Z.rows[Y]).html()}}I=this.align==="right"&&L!==0?true:false;var af=b.extend({},this.editoptions||{},{id:J,name:J}),ae=b.extend({},{rowabove:false,rowcontent:""},this.formoptions||{}),al=parseInt(ae.rowpos,10)||ad+1,an=parseInt((parseInt(ae.colpos,10)||1)*2,10);if(ae.rowabove){var am=b("<tr><td class='contentinfo' colspan='"+(Q*2)+"'>"+ae.rowcontent+"</td></tr>");b(X).append(am);am[0].rp=al}aa=b(X).find("tr[rowpos="+al+"]");if(aa.length===0){aa=b("<tr "+V+" rowpos='"+al+"'></tr>").addClass("FormData").attr("id","trv_"+J);b(aa).append(W);b(X).append(aa);aa[0].rp=al}b("td:eq("+(an-2)+")",aa[0]).html("<b>"+(typeof ae.label==="undefined"?Z.p.colNames[aj]:ae.label)+"</b>");b("td:eq("+(an-1)+")",aa[0]).append("<span>"+S+"</span>").attr("id","v_"+J);if(I){b("td:eq("+(an-1)+") span",aa[0]).css({"text-align":"right",width:L+"px"})}F[ad]=aj;ad++}});if(ad>0){var G=b("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(Q*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+O+"'/></td></tr>");G[0].rp=ad+99;b(X).append(G)}return F}function B(L,F){var H,G,K=0,J,I,M;M=b(F).jqGrid("getInd",L,true);if(!M){return}b("td",M).each(function(N){H=F.p.colModel[N].name;if(F.p.colModel[N].editrules&&F.p.colModel[N].editrules.edithidden===true){G=false}else{G=F.p.colModel[N].hidden===true?true:false}if(H!=="cb"&&H!=="subgrid"&&H!=="rn"){if(H==F.p.ExpandColumn&&F.p.treeGrid===true){J=b(this).text()}else{J=b(this).html()}I=b.extend({},F.p.colModel[N].editoptions||{});H=b.jgrid.jqID("v_"+H);b("#"+H+" span","#"+j).html(J);if(G){b("#"+H,"#"+j).parents("tr:first").hide()}K++}});if(K>0){b("#id_g","#"+j).val(L)}}})},delGridRow:function(c,d){d=b.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:false,drag:true,resize:true,url:"",mtype:"POST",reloadAfterSubmit:true,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:true,closeOnEscape:false,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:false,serializeDelData:null,useDataProxy:false},b.jgrid.del,d||{});a=d;return this.each(function(){var h=this;if(!h.grid){return}if(!c){return}var i=typeof d.beforeShowForm==="function"?true:false,m=typeof d.afterShowForm==="function"?true:false,l=h.p.id,r={},e="DelTbl_"+l,k,n,g,s,p={themodal:"delmod"+l,modalhead:"delhd"+l,modalcontent:"delcnt"+l,scrollelm:e};if(jQuery.isArray(c)){c=c.join()}if(b("#"+p.themodal).html()!=null){b("#DelData>td","#"+e).text(c);b("#DelError","#"+e).hide();if(a.processing===true){a.processing=false;b("#dData","#"+e).removeClass("ui-state-active")}if(i){d.beforeShowForm(b("#"+e))}viewModal("#"+p.themodal,{gbox:"#gbox_"+l,jqm:d.jqModal,jqM:false,modal:d.modal});if(m){d.afterShowForm(b("#"+e))}}else{var o=isNaN(d.dataheight)?d.dataheight:d.dataheight+"px";var f="<div id='"+e+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+o+";'>";f+="<table class='DelTable'><tbody>";f+="<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>";f+="<tr id='DelData' style='display:none'><td >"+c+"</td></tr>";f+='<tr><td class="delmsg" style="white-space:pre;">'+d.msg+"</td></tr><tr><td >&#160;</td></tr>";f+="</tbody></table></div>";var q="<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+d.bSubmit+"</a>",j="<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+d.bCancel+"</a>";f+="<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+e+"_2'><tbody><tr><td class='DataTD ui-widget-content'></td></tr><tr style='display:block;height:3px;'><td></td></tr><tr><td class='DelButton EditButton'>"+q+"&#160;"+j+"</td></tr></tbody></table>";d.gbox="#gbox_"+l;createModal(p,f,d,"#gview_"+h.p.id,b("#gview_"+h.p.id)[0]);b(".fm-button","#"+e+"_2").hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")});d.delicon=b.extend([true,"left","ui-icon-scissors"],d.delicon);d.cancelicon=b.extend([true,"left","ui-icon-cancel"],d.cancelicon);if(d.delicon[0]===true){b("#dData","#"+e+"_2").addClass(d.delicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+d.delicon[2]+"'></span>")}if(d.cancelicon[0]===true){b("#eData","#"+e+"_2").addClass(d.cancelicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+d.cancelicon[2]+"'></span>")}b("#dData","#"+e+"_2").click(function(w){var u=[true,""];r={};var v=b("#DelData>td","#"+e).text();if(typeof d.onclickSubmit==="function"){r=d.onclickSubmit(a,v)||{}}if(typeof d.beforeSubmit==="function"){u=d.beforeSubmit(v)}if(u[0]&&!a.processing){a.processing=true;b(this).addClass("ui-state-active");g=h.p.prmNames;k=b.extend({},a.delData,r);s=g.oper;k[s]=g.deloper;n=g.id;k[n]=v;var t=b.extend({url:a.url?a.url:b(h).jqGrid("getGridParam","editurl"),type:d.mtype,data:b.isFunction(d.serializeDelData)?d.serializeDelData(k):k,complete:function(A,B){if(B!="success"){u[0]=false;if(b.isFunction(a.errorTextFormat)){u[1]=a.errorTextFormat(A)}else{u[1]=B+" Status: '"+A.statusText+"'. Error code: "+A.status}}else{if(typeof a.afterSubmit==="function"){u=a.afterSubmit(A,k)}}if(u[0]===false){b("#DelError>td","#"+e).html(u[1]);b("#DelError","#"+e).show()}else{if(a.reloadAfterSubmit&&h.p.datatype!="local"){b(h).trigger("reloadGrid")}else{var x=[];x=v.split(",");if(h.p.treeGrid===true){try{b(h).jqGrid("delTreeNode",x[0])}catch(y){}}else{for(var z=0;z<x.length;z++){b(h).jqGrid("delRowData",x[z])}}h.p.selrow=null;h.p.selarrrow=[]}if(b.isFunction(a.afterComplete)){setTimeout(function(){a.afterComplete(A,v)},500)}}a.processing=false;b("#dData","#"+e+"_2").removeClass("ui-state-active");if(u[0]){hideModal("#"+p.themodal,{gb:"#gbox_"+l,jqm:d.jqModal,onClose:a.onClose})}},error:function(x,y,z){b("#DelError>td","#"+e).html(y+" : "+z);b("#DelError","#"+e).show();a.processing=false;b("#dData","#"+e+"_2").removeClass("ui-state-active")}},b.jgrid.ajaxOptions,d.ajaxDelOptions);if(!t.url&&!a.useDataProxy){if(b.isFunction(h.p.dataProxy)){a.useDataProxy=true}else{u[0]=false;u[1]+=" "+b.jgrid.errors.nourl}}if(u[0]){if(a.useDataProxy){h.p.dataProxy.call(h,t,"del_"+h.p.id)}else{b.ajax(t)}}}if(u[0]===false){b("#DelError>td","#"+e).html(u[1]);b("#DelError","#"+e).show()}return false});b("#eData","#"+e+"_2").click(function(t){hideModal("#"+p.themodal,{gb:"#gbox_"+l,jqm:d.jqModal,onClose:a.onClose});return false});if(i){d.beforeShowForm(b("#"+e))}viewModal("#"+p.themodal,{gbox:"#gbox_"+l,jqm:d.jqModal,modal:d.modal});if(m){d.afterShowForm(b("#"+e))}}if(d.closeOnEscape===true){setTimeout(function(){b(".ui-jqdialog-titlebar-close","#"+p.modalhead).focus()},0)}})},navGrid:function(h,d,g,c,i,f,e){d=b.extend({edit:true,editicon:"ui-icon-pencil",add:true,addicon:"ui-icon-plus",del:true,delicon:"ui-icon-trash",search:true,searchicon:"ui-icon-search",refresh:true,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:false,viewicon:"ui-icon-document",position:"left",closeOnEscape:true,beforeRefresh:null,afterRefresh:null,cloneToTop:false},b.jgrid.nav,d||{});return this.each(function(){var j={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},n=this,m,v,p,k;if(!n.grid||typeof h!="string"){return}if(b("#"+j.themodal).html()===null){if(typeof window.innerWidth!="undefined"){m=window.innerWidth;v=window.innerHeight}else{if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0){m=document.documentElement.clientWidth;v=document.documentElement.clientHeight}else{m=1024;v=768}}createModal(j,"<div>"+d.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+n.p.id,jqModal:true,drag:true,resize:true,caption:d.alertcap,top:v/2-25,left:m/2-100,width:200,height:"auto",closeOnEscape:d.closeOnEscape},"","",true)}var q=1;if(d.cloneToTop&&n.p.toppager){q=2}for(var o=0;o<q;o++){var r,t=b("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),u="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",l,s;if(o===0){l=h;s=n.p.id;if(l==n.p.toppager){s+="_top";q=1}}else{l=n.p.toppager;s=n.p.id+"_top"}if(n.p.direction=="rtl"){b(t).attr("dir","rtl").css("float","right")}if(d.add){c=c||{};r=b("<td class='ui-pg-button ui-corner-all'></td>");b(r).append("<div class='ui-pg-div'><span class='ui-icon "+d.addicon+"'></span>"+d.addtext+"</div>");b("tr",t).append(r);b(r,t).attr({title:d.addtitle||"",id:c.id||"add_"+s}).click(function(){if(!b(this).hasClass("ui-state-disabled")){if(typeof d.addfunc=="function"){d.addfunc()}else{b(n).jqGrid("editGridRow","new",c)}}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")});r=null}if(d.edit){r=b("<td class='ui-pg-button ui-corner-all'></td>");g=g||{};b(r).append("<div class='ui-pg-div'><span class='ui-icon "+d.editicon+"'></span>"+d.edittext+"</div>");b("tr",t).append(r);b(r,t).attr({title:d.edittitle||"",id:g.id||"edit_"+s}).click(function(){if(!b(this).hasClass("ui-state-disabled")){var w=n.p.selrow;if(w){if(typeof d.editfunc=="function"){d.editfunc(w)}else{b(n).jqGrid("editGridRow",w,g)}}else{viewModal("#"+j.themodal,{gbox:"#gbox_"+n.p.id,jqm:true});b("#jqg_alrt").focus()}}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")});r=null}if(d.view){r=b("<td class='ui-pg-button ui-corner-all'></td>");e=e||{};b(r).append("<div class='ui-pg-div'><span class='ui-icon "+d.viewicon+"'></span>"+d.viewtext+"</div>");b("tr",t).append(r);b(r,t).attr({title:d.viewtitle||"",id:e.id||"view_"+s}).click(function(){if(!b(this).hasClass("ui-state-disabled")){var w=n.p.selrow;if(w){b(n).jqGrid("viewGridRow",w,e)}else{viewModal("#"+j.themodal,{gbox:"#gbox_"+n.p.id,jqm:true});b("#jqg_alrt").focus()}}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")});r=null}if(d.del){r=b("<td class='ui-pg-button ui-corner-all'></td>");i=i||{};b(r).append("<div class='ui-pg-div'><span class='ui-icon "+d.delicon+"'></span>"+d.deltext+"</div>");b("tr",t).append(r);b(r,t).attr({title:d.deltitle||"",id:i.id||"del_"+s}).click(function(){if(!b(this).hasClass("ui-state-disabled")){var w;if(n.p.multiselect){w=n.p.selarrrow;if(w.length===0){w=null}}else{w=n.p.selrow}if(w){if("function"==typeof d.delfunc){d.delfunc(w)}else{b(n).jqGrid("delGridRow",w,i)}}else{viewModal("#"+j.themodal,{gbox:"#gbox_"+n.p.id,jqm:true});b("#jqg_alrt").focus()}}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")});r=null}if(d.add||d.edit||d.del||d.view){b("tr",t).append(u)}if(d.search){r=b("<td class='ui-pg-button ui-corner-all'></td>");f=f||{};b(r).append("<div class='ui-pg-div'><span class='ui-icon "+d.searchicon+"'></span>"+d.searchtext+"</div>");b("tr",t).append(r);b(r,t).attr({title:d.searchtitle||"",id:f.id||"search_"+s}).click(function(){if(!b(this).hasClass("ui-state-disabled")){b(n).jqGrid("searchGrid",f)}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")});r=null}if(d.refresh){r=b("<td class='ui-pg-button ui-corner-all'></td>");b(r).append("<div class='ui-pg-div'><span class='ui-icon "+d.refreshicon+"'></span>"+d.refreshtext+"</div>");b("tr",t).append(r);b(r,t).attr({title:d.refreshtitle||"",id:"refresh_"+s}).click(function(){if(!b(this).hasClass("ui-state-disabled")){if(b.isFunction(d.beforeRefresh)){d.beforeRefresh()}n.p.search=false;try{var w=n.p.id;b("#fbox_"+w).searchFilter().reset({reload:false});if(b.isFunction(n.clearToolbar)){n.clearToolbar(false)}}catch(x){}switch(d.refreshstate){case"firstpage":b(n).trigger("reloadGrid",[{page:1}]);break;case"current":b(n).trigger("reloadGrid",[{current:true}]);break}if(b.isFunction(d.afterRefresh)){d.afterRefresh()}}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")});r=null}k=b(".ui-jqgrid").css("font-size")||"11px";b("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+k+";visibility:hidden;' ></div>");p=b(t).clone().appendTo("#testpg2").width();b("#testpg2").remove();b(l+"_"+d.position,l).append(t);if(n.p._nvtd){if(p>n.p._nvtd[0]){b(l+"_"+d.position,l).width(p);n.p._nvtd[0]=p}n.p._nvtd[1]=p}k=null;p=null;t=null}})},navButtonAdd:function(c,d){d=b.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},d||{});return this.each(function(){if(!this.grid){return}if(c.indexOf("#")!==0){c="#"+c}var e=b(".navtable",c)[0],g=this;if(e){var f=b("<td></td>");if(d.buttonicon.toString().toUpperCase()=="NONE"){b(f).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+d.caption+"</div>")}else{b(f).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+d.buttonicon+"'></span>"+d.caption+"</div>")}if(d.id){b(f).attr("id",d.id)}if(d.position=="first"){if(e.rows[0].cells.length===0){b("tr",e).append(f)}else{b("tr td:eq(0)",e).before(f)}}else{b("tr",e).append(f)}b(f,e).attr("title",d.title||"").click(function(h){if(!b(this).hasClass("ui-state-disabled")){if(b.isFunction(d.onClickButton)){d.onClickButton.call(g,h)}}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")})}})},navSeparatorAdd:function(c,d){d=b.extend({sepclass:"ui-separator",sepcontent:""},d||{});return this.each(function(){if(!this.grid){return}if(c.indexOf("#")!==0){c="#"+c}var f=b(".navtable",c)[0];if(f){var e="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+d.sepclass+"'></span>"+d.sepcontent+"</td>";b("tr",f).append(e)}})},GridToForm:function(c,d){return this.each(function(){var g=this;if(!g.grid){return}var f=b(g).jqGrid("getRowData",c);if(f){for(var e in f){if(b("[name="+e+"]",d).is("input:radio")||b("[name="+e+"]",d).is("input:checkbox")){b("[name="+e+"]",d).each(function(){if(b(this).val()==f[e]){b(this).attr("checked","checked")}else{b(this).attr("checked","")}})}else{b("[name="+e+"]",d).val(f[e])}}}})},FormToGrid:function(d,e,f,c){return this.each(function(){var i=this;if(!i.grid){return}if(!f){f="set"}if(!c){c="first"}var g=b(e).serializeArray();var h={};b.each(g,function(j,k){h[k.name]=k.value});if(f=="add"){b(i).jqGrid("addRowData",d,h,c)}else{if(f=="set"){b(i).jqGrid("setRowData",d,h)}}})}})})(jQuery);