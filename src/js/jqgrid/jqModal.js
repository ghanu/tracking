(function(e){e.fn.jqm=function(a){var b={overlay:50,closeoverlay:true,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:q,ajaxText:"",target:q,modal:q,toTop:q,onShow:q,onHide:q,onLoad:q};return this.each(function(){if(this._jqm){return r[this._jqm].c=e.extend({},r[this._jqm].c,a)}p++;this._jqm=p;r[p]={c:e.extend(b,e.jqm.params,a),a:q,w:e(this).addClass("jqmID"+p),s:p};if(b.trigger){e(this).jqmAddTrigger(b.trigger)}})};e.fn.jqmAddClose=function(a){return s(this,a,"jqmHide")};e.fn.jqmAddTrigger=function(a){return s(this,a,"jqmShow")};e.fn.jqmShow=function(a){return this.each(function(){e.jqm.open(this._jqm,a)})};e.fn.jqmHide=function(a){return this.each(function(){e.jqm.close(this._jqm,a)})};e.jqm={hash:{},open:function(k,a){var l=r[k],j=l.c,b="."+j.closeClass,i=(parseInt(l.w.css("z-index")));i=(i>0)?i:3000;var c=e("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":i-1,opacity:j.overlay/100});if(l.a){return q}l.t=a;l.a=true;l.w.css("z-index",i);if(j.modal){if(!o[0]){setTimeout(function(){t("bind")},1)}o.push(k)}else{if(j.overlay>0){if(j.closeoverlay){l.w.jqmAddClose(c)}}else{c=q}}l.o=(c)?c.addClass(j.overlayClass).prependTo("body"):q;if(f){e("html,body").css({height:"100%",width:"100%"});if(c){c=c.css({position:"absolute"})[0];for(var h in {Top:1,Left:1}){c.style.setExpression(h.toLowerCase(),"(_=(document.documentElement.scroll"+h+" || document.body.scroll"+h+"))+'px'")}}}if(j.ajax){var d=j.target||l.w,g=j.ajax;d=(typeof d=="string")?e(d,l.w):e(d);g=(g.substr(0,1)=="@")?e(a).attr(g.substring(1)):g;d.html(j.ajaxText).load(g,function(){if(j.onLoad){j.onLoad.call(this,l)}if(b){l.w.jqmAddClose(e(b,l.w))}u(l)})}else{if(b){l.w.jqmAddClose(e(b,l.w))}}if(j.toTop&&l.o){l.w.before('<span id="jqmP'+l.w[0]._jqm+'"></span>').insertAfter(l.o)}(j.onShow)?j.onShow(l):l.w.show();u(l);return q},close:function(a){var b=r[a];if(!b.a){return q}b.a=q;if(o[0]){o.pop();if(!o[0]){t("unbind")}}if(b.c.toTop&&b.o){e("#jqmP"+b.w[0]._jqm).after(b.w).remove()}if(b.c.onHide){b.c.onHide(b)}else{b.w.hide();if(b.o){b.o.remove()}}return q},params:{}};var p=0,r=e.jqm.hash,o=[],f=e.browser.msie&&(e.browser.version=="6.0"),q=false,u=function(a){var b=e('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0});if(f){if(a.o){a.o.html('<p style="width:100%;height:100%"/>').prepend(b)}else{if(!e("iframe.jqm",a.w)[0]){a.w.prepend(b)}}}v(a)},v=function(a){try{e(":input:visible",a.w)[0].focus()}catch(b){}},t=function(a){e(document)[a]("keypress",m)[a]("keydown",m)[a]("mousedown",m)},m=function(a){var c=r[o[o.length-1]],b=(!e(a.target).parents(".jqmID"+c.s)[0]);if(b){v(c)}return !b},s=function(a,c,b){return a.each(function(){var d=this._jqm;e(c).each(function(){if(!this[b]){this[b]=[];e(this).click(function(){for(var h in {jqmShow:1,jqmHide:1}){for(var g in this[h]){if(r[this[h][g]]){r[this[h][g]].w[h](this)}}}return q})}this[b].push(d)})})}})(jQuery);